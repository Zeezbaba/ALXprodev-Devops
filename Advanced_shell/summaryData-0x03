#!/bin/bash

# Output CSV file
output_file="pokemon_report.csv"

# Header
echo "Name,Height (m),Weight (kg)" > "$output_file"

# Loop through JSON files
for file in pokemon_data/*.json
do
  # Extract name, height (in meters), and weight (in kg)
  name=$(jq -r '.name' "$file" | sed 's/.*/\u&/')  # Capitalize first letter
  height=$(jq '.height' "$file" | awk '{printf "%.2f", $1 / 10}')
  weight=$(jq '.weight' "$file" | awk '{printf "%.1f", $1 / 10}')
  
  echo "$name,$height,$weight" >> "$output_file"
done

# Display message
echo "CSV Report generated at: $output_file"
echo ""

# Show contents
cat "$output_file"

# Calculate averages
awk -F, 'NR>1 { h+=$2; w+=$3; n++ } END { 
  printf "\nAverage Height: %.2f m\n", h/n
  printf "Average Weight: %.2f kg\n", w/n
}' "$output_file"